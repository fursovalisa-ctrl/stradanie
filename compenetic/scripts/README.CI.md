# ‚öôÔ∏è CI/CD –ü–∞–π–ø–ª–∞–π–Ω—ã

–ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º CI/CD –≤ –ø—Ä–æ–µ–∫—Ç–µ.

### ‚ú® –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚ö°Ô∏è **–ë—ã—Å—Ç—Ä–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ `node_modules` –Ω–∞ –æ—Å–Ω–æ–≤–µ `yarn.lock`.
- üõ°Ô∏è **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π, —Ç–µ—Å—Ç—ã –∏ —Å–±–æ—Ä–∫–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –∫–æ–º–º–∏—Ç –≤ `feature/*` –∏ —Ç–µ–≥–∏.
- üì¶ **–ì–∏–±–∫–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ—Å—Ç–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ pre-release –≤–µ—Ä—Å–∏–π –¥–ª—è `feature`-–≤–µ—Ç–æ–∫ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä—É—á–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ä–µ–ª–∏–∑–æ–≤.
- üìú **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å:** –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Å–∫—Ä–∏–ø—Ç `scripts/.gitlab-ci.sh`.

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤

- **–í–µ—Ç–∫–∏ `feature/*`**:
  `install` ‚û°Ô∏è `test` ‚û°Ô∏è `build` ‚û°Ô∏è `publish-prerelease` (—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫)

- **–í–µ—Ç–∫–∞ `main`**:
  `create-release-tag` (—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫) ‚û°Ô∏è –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è —Ç–µ–≥–∞

- **–¢–µ–≥–∏**:
  `version-check` ‚û°Ô∏è `install` ‚û°Ô∏è `test` ‚û°Ô∏è `build` ‚û°Ô∏è `publish-release` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### üìù –≠—Ç–∞–ø—ã (Stages)

| –≠—Ç–∞–ø              | –û–ø–∏—Å–∞–Ω–∏–µ                                                              | –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è              |
| ----------------- | --------------------------------------------------------------------- | ------------------------ |
| `version-check`   | ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–∏ –≤ `package.json` –∏ Git-—Ç–µ–≥–∞.         | –¢–æ–ª—å–∫–æ –Ω–∞ —Ç–µ–≥–∞—Ö          |
| `install`         | üì• –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`yarn install --frozen-lockfile`).      | –ù–∞ `feature/*` –∏ —Ç–µ–≥–∞—Ö   |
| `test`            | üß™ –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã (`yarn test`).                                     | –ù–∞ `feature/*` –∏ —Ç–µ–≥–∞—Ö   |
| `build`           | üèóÔ∏è –°–æ–±–∏—Ä–∞–µ—Ç production-—Å–±–æ—Ä–∫—É –≤ `dist/`.                              | –ù–∞ `feature/*` –∏ —Ç–µ–≥–∞—Ö   |
| `publish`         | üöÄ –ü—É–±–ª–∏–∫—É–µ—Ç –ø–∞–∫–µ—Ç –≤ NPM (pre-release –∏–ª–∏ release).                   | –°–º. –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∏–∂–µ        |

### üîÑ –ü—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–±–æ—Ç—ã (Workflows)

| –°—Ü–µ–Ω–∞—Ä–∏–π            | –¢—Ä–∏–≥–≥–µ—Ä                                                    | –î–µ–π—Å—Ç–≤–∏–µ                                       | –†–µ–∑—É–ª—å—Ç–∞—Ç üèÜ                                                                 |
| ------------------- | ---------------------------------------------------------- | ---------------------------------------------- | ---------------------------------------------------------------------------- |
| **Pre-release** üß™  | –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ `publish-prerelease` –Ω–∞ `feature/*` –≤–µ—Ç–∫–µ.   | –ü—É–±–ª–∏–∫–∞—Ü–∏—è NPM-–ø–∞–∫–µ—Ç–∞ —Å —Ç–µ–≥–æ–º –≤–µ—Ç–∫–∏.           | –ü–∞–∫–µ—Ç `name@feature-name` –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.                         |
| **Release** üéâ      | **–®–∞–≥ 1:** –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ `create-release-tag` –Ω–∞ `main`.   | –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—É—à Git-—Ç–µ–≥–∞ `vX.Y.Z`.              | –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è —Ç–µ–≥–∞.                                               |
|                     | **–®–∞–≥ 2:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø–æ –Ω–æ–≤–æ–º—É —Ç–µ–≥—É.           | –ü—É–±–ª–∏–∫–∞—Ü–∏—è NPM-–ø–∞–∫–µ—Ç–∞ —Å —Ç–µ–≥–æ–º `latest`.        | –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è `name@latest` –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º.                               |

### üîë –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `NPM_TOKEN`: **(–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)** –¢–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ NPM. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–¥–∞–Ω –≤ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞ –≤ GitLab (`Settings > CI/CD > Variables`).

### üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ pre-release –≤–µ—Ä—Å–∏–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –∏–∑ feature-–≤–µ—Ç–∫–∏
npm install skillgrid@dev-36347-gornyi

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é pre-release –≤–µ—Ä—Å–∏—é
npm install skillgrid@0.0.21-dev-36347-gornyi.1125649
```
